<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Godot vs Jolt Parallel Comparison | Ayin</title><meta name="author" content="YiZhen"><meta name="copyright" content="YiZhen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Parallel Thread Pool Design Comparison">
<meta property="og:type" content="article">
<meta property="og:title" content="Godot vs Jolt Parallel Comparison">
<meta property="og:url" content="https://ayinzhang.github.io/en/2026/01/17/2026-1-17-Godot%20Jolt%20Parallel%20Comparison/index.html">
<meta property="og:site_name" content="Ayin">
<meta property="og:description" content="Parallel Thread Pool Design Comparison">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://picx.zhimg.com/v2-d28e53e000188ec10622ace95af2cfcb_1440w.png?source=ccfced1a">
<meta property="article:published_time" content="2026-01-16T16:00:00.000Z">
<meta property="article:modified_time" content="2026-01-18T09:38:14.416Z">
<meta property="article:author" content="YiZhen">
<meta property="article:tag" content="Engine Tools">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picx.zhimg.com/v2-d28e53e000188ec10622ace95af2cfcb_1440w.png?source=ccfced1a"><link rel="shortcut icon" href="https://fastly.jsdelivr.net/gh/ayinzhang/ayinzhang.github.io/img/icon.png"><link rel="canonical" href="https://ayinzhang.github.io/en/2026/01/17/2026-1-17-Godot%20Jolt%20Parallel%20Comparison/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/en/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?f74029fa7cc77ea7995800ef7950497d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/en/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"EN","msgToSimplifiedChinese":"ZH"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Godot vs Jolt Parallel Comparison',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-01-18 17:38:14'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/en/img/me.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">26</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="https://ayinzhang.github.io/"><i class="fa-fw fas fa-c"></i><span> Language</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/v2-d28e53e000188ec10622ace95af2cfcb_1440w.png?source=ccfced1a')"><nav id="nav"><span id="blog-info"><a href="/en/" title="Ayin"><span class="site-name">Ayin</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="https://ayinzhang.github.io/"><i class="fa-fw fas fa-c"></i><span> Language</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Godot vs Jolt Parallel Comparison</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-01-16T16:00:00.000Z" title="Created 2026-01-17 00:00:00">2026-01-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-01-18T09:38:14.416Z" title="Updated 2026-01-18 17:38:14">2026-01-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Technology-Sharing/">Technology Sharing</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Technology-Sharing/Engine-Related/">Engine-Related</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Godot vs Jolt Parallel Comparison"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="Written-before"><a href="#Written-before" class="headerlink" title="Written before"></a>Written before</h3><p>&emsp;&emsp;The previous article <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/1993709559378891870">Godot Physics Source Code Analysis</a> analyzed the built-in 3D physics pipeline in Godot. Extending from that, the next topic would be the Jolt physics engine integrated in version 4.4. Initially, I considered writing a separate article introducing it, but upon review, I felt that Godot’s integration of Jolt is relatively simplistic. In terms of functionality, it has been aligned and limited to match Godot’s existing physics capabilities. In terms of performance, an adapter layer was added to route calls back to Godot’s generic thread pool for parallelization. Rather than introducing Jolt within Godot, it might be more insightful to discuss them independently and compare their approaches.</p>
<p>&emsp;&emsp;What is the most differentiating aspect among physics engines? In my opinion, it’s not the algorithms (Impulse, PBD) but the parallelization strategies. How constraint islands are constructed and partitioned, and how the thread pool is designed—these directly determine efficiency and can yield drastically different performance across platforms. The following sections will compare these two aspects.</p>
<h3 id="Constraint-Construction"><a href="#Constraint-Construction" class="headerlink" title="Constraint Construction"></a>Constraint Construction</h3><p>&emsp;&emsp;Let’s start with the relatively simpler constraint construction, as Godot’s logic here is quite straightforward. As mentioned previously, it’s divided into three distinct logics for Areas, RigidBodies, and SoftBodies. Simply put, the Area part just throws any associated object in (since no computation is performed). RigidBodies detect associated RigidBodies and SoftBodies. SoftBodies only detect associated RigidBodies.</p>
<p>&emsp;In contrast, Jolt’s handling is more complex, implementing an 8-bit mask graph partitioning logic, where 7 bits are for parallel groups and 1 bit for non-parallel, corresponding to typical 8-core CPUs. To improve parallel efficiency, with dynamic splitting enabled, Jolt splits constraint groups whose constraint count exceeds a split threshold (default: 128). It then checks the split bits; if a split doesn’t reach a merge threshold (default: 16), it’s merged into the non-parallel group; otherwise, a new parallel group is created. The detailed flow is as follows:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">LargeIslandSplitter::SplitIsland</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="comment">// 1. Obtain island data → Check size threshold → If less than 128, return false</span></span><br><span class="line">        <span class="comment">// 2. Reset object masks → Calculate constraint count per split region</span></span><br><span class="line">        <span class="comment">// 3. Split contact points (mask coloring algorithm)</span></span><br><span class="line">        <span class="comment">//     - Get the two objects associated with the contact point</span></span><br><span class="line">        <span class="comment">//     - Find the first common, unused bit in the masks of these two objects</span></span><br><span class="line">        <span class="comment">//     - Set that bit to &#x27;1&#x27; and record the split index</span></span><br><span class="line">        <span class="comment">// 4. Allocate split operations for constraints (invoke constraint-specific logic)</span></span><br><span class="line">        <span class="comment">// 5. Create split structure and merge small splits</span></span><br><span class="line">        <span class="comment">//     - Iterate through the 8 split bits</span></span><br><span class="line">        <span class="comment">//     - If the number of constraints plus contact points in a split is less than 16, merge into the non-parallel split (bit 7)</span></span><br><span class="line">        <span class="comment">//     - Otherwise, create a new parallel split</span></span><br><span class="line">        <span class="comment">// 6. Reorder data by split</span></span><br><span class="line">        <span class="comment">//     - Group and store contact points and constraint indices by split</span></span><br><span class="line">        <span class="comment">//     - Improve cache hit rate</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Constraint-Solving"><a href="#Constraint-Solving" class="headerlink" title="Constraint Solving"></a>Constraint Solving</h3><p>&emsp;&emsp;Next is the solving stage. As mentioned earlier, this discussion does not involve specific solving algorithms but focuses on thread pool scheduling. Godot uses a generic thread pool with high&#x2F;low priority queue scheduling, using semaphores + condition variables for waiting; whereas Jolt uses a physics-specific thread pool based on task dependency graph scheduling with barrier waits.</p>
<h4 id="Godot-Generic-Thread-Pool"><a href="#Godot-Generic-Thread-Pool" class="headerlink" title="Godot Generic Thread Pool"></a>Godot Generic Thread Pool</h4><p>&emsp;&emsp;First, the general workflow of Godot’s thread pool: initialization, task submission, thread execution, cooperative waiting, cleanup. The specific flow is as follows:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> Initialization Phase:</span><br><span class="line">    - Create a specified number of worker threads</span><br><span class="line">    - Set the proportion of low-priority threads</span><br><span class="line">    - Establish thread index mapping</span><br><span class="line"><span class="number">2.</span> Task Submission:</span><br><span class="line">    - <span class="function">Create a task <span class="title">object</span> <span class="params">(allocate memory)</span></span></span><br><span class="line"><span class="function">    - Place it into the corresponding queue based on priority</span></span><br><span class="line"><span class="function">    - Notify idle threads</span></span><br><span class="line"><span class="function">3. Thread Execution:</span></span><br><span class="line"><span class="function">    - Fetch a task from the queue</span></span><br><span class="line"><span class="function">    - Execute the task (script/native function)</span></span><br><span class="line"><span class="function">    - Handle task group synchronization</span></span><br><span class="line"><span class="function">    - Send completion notification</span></span><br><span class="line"><span class="function"><span class="number">4.</span> Cooperative Waiting:</span></span><br><span class="line"><span class="function">    - Worker threads can cooperatively process other tasks while waiting</span></span><br><span class="line"><span class="function">    - Includes deadlock prevention mechanisms</span></span><br><span class="line"><span class="function">    - Supports pause/resume mechanisms</span></span><br><span class="line"><span class="function"><span class="number">5.</span> Cleanup Phase:</span></span><br><span class="line"><span class="function">    - Gradual shutdown</span></span><br><span class="line"><span class="function">    - Wait for all tasks to complete</span></span><br><span class="line"><span class="function">    - Destroy the thread pool</span></span><br></pre></td></tr></table></figure>

<h4 id="Basic-Structure"><a href="#Basic-Structure" class="headerlink" title="Basic Structure"></a>Basic Structure</h4><p>&emsp;&emsp;The basic structure of Godot’s generic thread pool is roughly as follows, using a dual-queue system to balance responsiveness and throughput, and paged allocation to reduce memory fragmentation.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class structure and main members</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WorkerThreadPool</span> : <span class="keyword">public</span> Object &#123;</span><br><span class="line">    <span class="built_in">GDCLASS</span>(WorkerThreadPool, Object)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Use TaskID and GroupID as the task identifiers</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">int64_t</span> TaskID;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">int64_t</span> GroupID;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Task</span>;      <span class="comment">// Task Structure</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Group</span>;     <span class="comment">// Task Group Structure</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">ThreadData</span>; <span class="comment">// Thread Data</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Core Data Stucture</span></span><br><span class="line">    PagedAllocator&lt;Task, <span class="literal">false</span>, TASKS_PAGE_SIZE&gt; task_allocator;</span><br><span class="line">    PagedAllocator&lt;Group, <span class="literal">false</span>, GROUPS_PAGE_SIZE&gt; group_allocator;</span><br><span class="line">    </span><br><span class="line">    SelfList&lt;Task&gt;::List low_priority_task_queue;  <span class="comment">// Low-priority queue</span></span><br><span class="line">    SelfList&lt;Task&gt;::List task_queue;               <span class="comment">// High-priority queue</span></span><br><span class="line">    BinaryMutex task_mutex;                        <span class="comment">// Mutual exclusion lock to protect task queue</span></span><br><span class="line">    </span><br><span class="line">    TightLocalVector&lt;ThreadData&gt; threads;          <span class="comment">// Thread data array</span></span><br><span class="line">    HashMap&lt;Thread::ID, <span class="type">int</span>&gt; thread_ids;          <span class="comment">// Thread IDs to indices Map</span></span><br><span class="line">    HashMap&lt;TaskID, Task *&gt; tasks;                 <span class="comment">// All tasks map</span></span><br><span class="line">    HashMap&lt;GroupID, Group *&gt; groups;              <span class="comment">// All task groups map</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Memory Management for Tasks and Groups</span></span><br><span class="line"><span class="comment">// Use the paging allocator to reduce memory fragmentation.</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> TASKS_PAGE_SIZE = <span class="number">1024</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> GROUPS_PAGE_SIZE = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Obtain the Task from the distributor instead of creating one.</span></span><br><span class="line">Task *task = task_allocator.<span class="built_in">alloc</span>();</span><br><span class="line"><span class="comment">// Return after use</span></span><br><span class="line">task_allocator.<span class="built_in">free</span>(task);</span><br></pre></td></tr></table></figure>

<h4 id="Cooperative-Waiting"><a href="#Cooperative-Waiting" class="headerlink" title="Cooperative Waiting"></a>Cooperative Waiting</h4><p>&emsp;&emsp;The most interesting aspect is likely the cooperative waiting mechanism: worker threads don’t idle while waiting but continue processing other tasks. This is particularly useful for handling task dependencies, effectively preventing deadlocks and improving CPU utilization.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> WorkerThreadPool::_wait_collaboratively(ThreadData *p_caller_pool_thread, Task *p_task) &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="function">MutexLock <span class="title">lock</span><span class="params">(task_mutex)</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Check if the waiting period has ended</span></span><br><span class="line">        <span class="keyword">if</span> (p_task-&gt;completed) <span class="keyword">break</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Try to do other tasks</span></span><br><span class="line">        <span class="keyword">if</span> (task_queue.<span class="built_in">first</span>()) &#123;</span><br><span class="line">            Task *next_task = task_queue.<span class="built_in">first</span>()-&gt;<span class="built_in">self</span>();</span><br><span class="line">            task_queue.<span class="built_in">remove</span>(task_queue.<span class="built_in">first</span>());</span><br><span class="line">            lock.<span class="built_in">unlock</span>();</span><br><span class="line">            _process_task(next_task);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Waiting for a condition variable</span></span><br><span class="line">            p_caller_pool_thread-&gt;awaited_task = p_task;</span><br><span class="line">            p_caller_pool_thread-&gt;cond_var.<span class="built_in">wait</span>(lock);</span><br><span class="line">            p_caller_pool_thread-&gt;awaited_task = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Jolt-Physics-Thread-Pool"><a href="#Jolt-Physics-Thread-Pool" class="headerlink" title="Jolt Physics Thread Pool"></a>Jolt Physics Thread Pool</h4><p>&emsp;&emsp;Next is Jolt’s physics thread pool. Its general workflow is: initialization, task submission, thread execution, barrier synchronization, cleanup. The specific flow is as follows:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> Initialization Phase:</span><br><span class="line">    - Initialize task free list <span class="keyword">and</span> barrier free list</span><br><span class="line">    - Create a specified number of worker threads</span><br><span class="line">    - Set thread initialization/exit callback functions</span><br><span class="line"><span class="number">2.</span> Task Creation:</span><br><span class="line">    - Allocate a task object from the free list</span><br><span class="line">    - Set task name, color, execution function, <span class="keyword">and</span> dependency count</span><br><span class="line">    - If dependency count is <span class="number">0</span>, enqueue the task immediately</span><br><span class="line"><span class="number">3.</span> Task Enqueuing:</span><br><span class="line">    - Add the task to the circular queue</span><br><span class="line">    - Use atomic operations to manage queue head <span class="keyword">and</span> tail</span><br><span class="line">    - Release semaphore to wake worker threads</span><br><span class="line"><span class="number">4.</span> Worker Thread Loop:</span><br><span class="line">    - Wait <span class="keyword">for</span> semaphore</span><br><span class="line">    - Fetch tasks from the queue <span class="keyword">and</span> execute them</span><br><span class="line">    - After task execution completes, decrement the dependency count of its successor tasks</span><br><span class="line">    - If a successor task<span class="number">&#x27;</span>s dependency count becomes <span class="number">0</span>, enqueue it <span class="keyword">for</span> processing</span><br><span class="line"><span class="number">5.</span> Barrier Synchronization:</span><br><span class="line">    - Use barriers to wait <span class="keyword">for</span> a set of tasks to complete</span><br><span class="line">    - <span class="function">The main thread can also participate in task <span class="title">execution</span> <span class="params">(wait at the barrier)</span></span></span><br><span class="line"><span class="function">6. Cleanup Phase:</span></span><br><span class="line"><span class="function">    - Stop running threads</span></span><br><span class="line"><span class="function">    - Wait for all threads to finish</span></span><br><span class="line"><span class="function">    - Release allocated resources</span></span><br></pre></td></tr></table></figure>

<h4 id="Basic-Structure-1"><a href="#Basic-Structure-1" class="headerlink" title="Basic Structure"></a>Basic Structure</h4><p>&emsp;&emsp;The basic structure of Jolt’s physics thread pool is roughly as follows. It uses a ring-based lock-free queue and fixed-size memory pools.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">JobSystemThreadPool</span> <span class="keyword">final</span> : <span class="keyword">public</span> JobSystemWithBarrier &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// Task memory pool (fixed size)</span></span><br><span class="line">    FixedSizeFreeList&lt;Job&gt; mJobs;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Array of worker threads</span></span><br><span class="line">    Array&lt;thread&gt; mThreads;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Circular Queue (Lock-Free Design)</span></span><br><span class="line">    <span class="type">static</span> <span class="keyword">constexpr</span> uint32 cQueueLength = <span class="number">1024</span>;</span><br><span class="line">    atomic&lt;Job *&gt; mQueue[cQueueLength];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// The local head pointer of each thread + the global tail pointer</span></span><br><span class="line">    atomic&lt;uint&gt; *mHeads = <span class="literal">nullptr</span>;  <span class="comment">// One head per thread</span></span><br><span class="line">    atomic&lt;uint&gt; mTail = <span class="number">0</span>;          <span class="comment">// Global tail</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Semaphores are used for thread wake-up.</span></span><br><span class="line">    Semaphore mSemaphore;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Exit indicator</span></span><br><span class="line">    atomic&lt;<span class="type">bool</span>&gt; mQuit = <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Barrier-Synchronization"><a href="#Barrier-Synchronization" class="headerlink" title="Barrier Synchronization"></a>Barrier Synchronization</h4><p>&emsp;&emsp;In my view, Jolt’s barrier is a physics-specialized version of Godot’s cooperative waiting, suitable for synchronizing physics phases.</p>
<p>&emsp;&emsp;The barrier structure is as follows, with read and write pointers aligned to different cache lines to avoid cache invalidation across cores.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BarrierImpl</span> : <span class="keyword">public</span> Barrier &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> <span class="keyword">constexpr</span> uint cMaxJobs = <span class="number">2048</span>;  <span class="comment">// Maximum number of tasks (a power of 2)</span></span><br><span class="line">    atomic&lt;Job *&gt; mJobs[cMaxJobs]; <span class="comment">// Use circular buffer stores tasks</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Read-write pointer (cache alignment in line to avoid false sharing)</span></span><br><span class="line">    <span class="built_in">alignas</span>(JPH_CACHE_LINE_SIZE) atomic&lt;uint&gt; mJobReadIndex &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">alignas</span>(JPH_CACHE_LINE_SIZE) atomic&lt;uint&gt; mJobWriteIndex &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Synchronous Control</span></span><br><span class="line">    atomic&lt;<span class="type">int</span>&gt; mNumToAcquire &#123; <span class="number">0</span> &#125;;  <span class="comment">// The required count of semaphores</span></span><br><span class="line">    Semaphore mSemaphore;             <span class="comment">// Task Completion Semaphore</span></span><br><span class="line">    </span><br><span class="line">    atomic&lt;<span class="type">bool</span>&gt; mInUse &#123; <span class="literal">false</span> &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;The logic for adding multiple tasks is as follows. The barrier supports batch task addition to reduce synchronization overhead:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">BarrierImpl::AddJobs</span><span class="params">(<span class="type">const</span> JobHandle *inHandles, uint inNumHandles)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> release_semaphore = <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> JobHandle *handle = inHandles; </span><br><span class="line">         handle &lt; inHandles + inNumHandles; ++handle) &#123;</span><br><span class="line">        Job *job = handle-&gt;<span class="built_in">GetPtr</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (job-&gt;<span class="built_in">SetBarrier</span>(<span class="keyword">this</span>)) &#123;</span><br><span class="line">            mNumToAcquire++;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Release the semaphore only when the first executable task is completed</span></span><br><span class="line">            <span class="keyword">if</span> (!release_semaphore &amp;&amp; job-&gt;<span class="built_in">CanBeExecuted</span>()) &#123;</span><br><span class="line">                release_semaphore = <span class="literal">true</span>;</span><br><span class="line">                mNumToAcquire++;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Add to buffer</span></span><br><span class="line">            job-&gt;<span class="built_in">AddRef</span>();</span><br><span class="line">            uint write_index = mJobWriteIndex++;</span><br><span class="line">            <span class="keyword">while</span> (write_index - mJobReadIndex &gt;= cMaxJobs) &#123;</span><br><span class="line">                std::this_thread::<span class="built_in">sleep_for</span>(std::chrono::<span class="built_in">microseconds</span>(<span class="number">100</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            mJobs[write_index &amp; (cMaxJobs - <span class="number">1</span>)] = job;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Notify after the batch processing is completed.</span></span><br><span class="line">    <span class="keyword">if</span> (release_semaphore) mSemaphore.<span class="built_in">Release</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;The core waiting mechanism is as follows. It also employs cooperative waiting, balancing efficiency and correctness.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">BarrierImpl::Wait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Loop until all tasks are completed</span></span><br><span class="line">    <span class="keyword">while</span> (mNumToAcquire &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">bool</span> has_executed;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            has_executed = <span class="literal">false</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// A. Clean the completed job</span></span><br><span class="line">            <span class="keyword">while</span> (mJobReadIndex &lt; mJobWriteIndex) &#123;</span><br><span class="line">                atomic&lt;Job *&gt; &amp;job = mJobs[mJobReadIndex &amp; (cMaxJobs - <span class="number">1</span>)];</span><br><span class="line">                Job *job_ptr = job.<span class="built_in">load</span>();</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (job_ptr == <span class="literal">nullptr</span> || !job_ptr-&gt;<span class="built_in">IsDone</span>()) <span class="keyword">break</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Release completed tasks</span></span><br><span class="line">                job_ptr-&gt;<span class="built_in">Release</span>();</span><br><span class="line">                job = <span class="literal">nullptr</span>;</span><br><span class="line">                ++mJobReadIndex;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// B. Search and excute tasks</span></span><br><span class="line">            <span class="keyword">for</span> (uint index = mJobReadIndex; index &lt; mJobWriteIndex; ++index) &#123;</span><br><span class="line">                <span class="type">const</span> atomic&lt;Job *&gt; &amp;job = mJobs[index &amp; (cMaxJobs - <span class="number">1</span>)];</span><br><span class="line">                Job *job_ptr = job.<span class="built_in">load</span>();</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (job_ptr != <span class="literal">nullptr</span> &amp;&amp; job_ptr-&gt;<span class="built_in">CanBeExecuted</span>()) &#123;</span><br><span class="line">                    job_ptr-&gt;<span class="built_in">Execute</span>();</span><br><span class="line">                    has_executed = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">while</span> (has_executed);  <span class="comment">// As long as there is a task to be executed, continue.</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// C. Wait for semaphore</span></span><br><span class="line">        <span class="type">int</span> num_to_acquire = <span class="built_in">max</span>(<span class="number">1</span>, mSemaphore.<span class="built_in">GetValue</span>());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Batch acquisition of semaphores (to reduce context switching)</span></span><br><span class="line">        mSemaphore.<span class="built_in">Acquire</span>(num_to_acquire);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Reduce waiting count</span></span><br><span class="line">        mNumToAcquire -= num_to_acquire;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="comment">// D. Final Cleanup (Ensure that all tasks have been released)</span></span><br><span class="line">    <span class="keyword">while</span> (mJobReadIndex &lt; mJobWriteIndex) &#123;</span><br><span class="line">        atomic&lt;Job *&gt; &amp;job = mJobs[mJobReadIndex &amp; (cMaxJobs - <span class="number">1</span>)];</span><br><span class="line">        Job *job_ptr = job.<span class="built_in">load</span>();</span><br><span class="line">        job_ptr-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        job = <span class="literal">nullptr</span>;</span><br><span class="line">        ++mJobReadIndex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>&emsp;&emsp;By comparing the implementations of physical parallelization between Godot and the original Jolt, we can see clear differences in their design goals. Godot adopts a highly generic thread pool and task system, leaning more towards overall engine consistency and maintainability. In contrast, Jolt builds a dedicated Job System, dependency graph, and barrier mechanisms centered around physics computation itself to maximize parallel efficiency in the physics phase. In Godot’s current integration of Jolt, Jolt’s tasks are ultimately adapted back to Godot’s generic thread pool, which is feasible in terms of functionality but means that the native parallelization design advantages are not fully leveraged.</p>
<p>&emsp;&emsp;In comparison, Unreal Engine (Chaos) decomposes physics tasks and integrates them into the engine-level scheduling system via a Task Graph, giving it stronger adaptability across different hardware platforms. This “task-centric rather than thread-centric” design makes it easier to fully utilize multi-core CPUs in complex scenarios. Truly, UE is unmatched. I give up.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://ayinzhang.github.io/en">YiZhen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://ayinzhang.github.io/en/2026/01/17/2026-1-17-Godot%20Jolt%20Parallel%20Comparison/">https://ayinzhang.github.io/en/2026/01/17/2026-1-17-Godot%20Jolt%20Parallel%20Comparison/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/Engine-Tools/">Engine Tools</a></div><div class="post_share"><div class="social-share" data-image="https://picx.zhimg.com/v2-d28e53e000188ec10622ace95af2cfcb_1440w.png?source=ccfced1a" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>Sponsor</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/en/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/en/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/en/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/en/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/en/2026/01/15/2026-1-15-Analysis%20of%20Godot%20Physics%20Source%20Code/" title="Analysis of Godot Physics Source Code"><img class="cover" src="https://picx.zhimg.com/v2-a58a4e744580865dce7d671dfb7ebbb3_1440w.png?source=ccfced1a" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Analysis of Godot Physics Source Code</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/en/2026/01/15/2026-1-15-Analysis%20of%20Godot%20Physics%20Source%20Code/" title="Analysis of Godot Physics Source Code"><img class="cover" src="https://picx.zhimg.com/v2-a58a4e744580865dce7d671dfb7ebbb3_1440w.png?source=ccfced1a" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-15</div><div class="title">Analysis of Godot Physics Source Code</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/en/img/me.jpg" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">YiZhen</div><div class="author-info__description">End Apocalypse</div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">26</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ayinzhang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ayinzhang" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1242857339@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">It's just a little wind frost</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Written-before"><span class="toc-number">1.</span> <span class="toc-text">Written before</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Constraint-Construction"><span class="toc-number">2.</span> <span class="toc-text">Constraint Construction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Constraint-Solving"><span class="toc-number">3.</span> <span class="toc-text">Constraint Solving</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Godot-Generic-Thread-Pool"><span class="toc-number">3.1.</span> <span class="toc-text">Godot Generic Thread Pool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Basic-Structure"><span class="toc-number">3.2.</span> <span class="toc-text">Basic Structure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cooperative-Waiting"><span class="toc-number">3.3.</span> <span class="toc-text">Cooperative Waiting</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Jolt-Physics-Thread-Pool"><span class="toc-number">3.4.</span> <span class="toc-text">Jolt Physics Thread Pool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Basic-Structure-1"><span class="toc-number">3.5.</span> <span class="toc-text">Basic Structure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Barrier-Synchronization"><span class="toc-number">3.6.</span> <span class="toc-text">Barrier Synchronization</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">4.</span> <span class="toc-text">Summary</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/2026/01/17/2026-1-17-Godot%20Jolt%20Parallel%20Comparison/" title="Godot vs Jolt Parallel Comparison"><img src="https://picx.zhimg.com/v2-d28e53e000188ec10622ace95af2cfcb_1440w.png?source=ccfced1a" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Godot vs Jolt Parallel Comparison"/></a><div class="content"><a class="title" href="/en/2026/01/17/2026-1-17-Godot%20Jolt%20Parallel%20Comparison/" title="Godot vs Jolt Parallel Comparison">Godot vs Jolt Parallel Comparison</a><time datetime="2026-01-16T16:00:00.000Z" title="Created 2026-01-17 00:00:00">2026-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/2026/01/15/2026-1-15-Analysis%20of%20Godot%20Physics%20Source%20Code/" title="Analysis of Godot Physics Source Code"><img src="https://picx.zhimg.com/v2-a58a4e744580865dce7d671dfb7ebbb3_1440w.png?source=ccfced1a" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Analysis of Godot Physics Source Code"/></a><div class="content"><a class="title" href="/en/2026/01/15/2026-1-15-Analysis%20of%20Godot%20Physics%20Source%20Code/" title="Analysis of Godot Physics Source Code">Analysis of Godot Physics Source Code</a><time datetime="2026-01-14T16:00:00.000Z" title="Created 2026-01-15 00:00:00">2026-01-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/2026/01/07/2026-1-7-Simply%20Exploration%20of%20Unity%20ML-Agents%20Reinforcement%20Learning/" title="Simply Exploration of Unity ML-Agents Reinforcement Learning"><img src="https://picx.zhimg.com/v2-42d063eae19380631578c7a1af6acddd_1440w.png?source=ccfced1a" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Simply Exploration of Unity ML-Agents Reinforcement Learning"/></a><div class="content"><a class="title" href="/en/2026/01/07/2026-1-7-Simply%20Exploration%20of%20Unity%20ML-Agents%20Reinforcement%20Learning/" title="Simply Exploration of Unity ML-Agents Reinforcement Learning">Simply Exploration of Unity ML-Agents Reinforcement Learning</a><time datetime="2026-01-06T16:00:00.000Z" title="Created 2026-01-07 00:00:00">2026-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/2025/12/19/2025-12-19-Simply%20Exploration%20of%20LLM%20PEFT%20Fine-tuning%20and%20Ollama%20Operation/" title="Simply Exploration of LLM PEFT Fine-tuning and Ollama Operation"><img src="https://pic1.zhimg.com/v2-71b0fc16e8b2f0e3771e38494b646666_r.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Simply Exploration of LLM PEFT Fine-tuning and Ollama Operation"/></a><div class="content"><a class="title" href="/en/2025/12/19/2025-12-19-Simply%20Exploration%20of%20LLM%20PEFT%20Fine-tuning%20and%20Ollama%20Operation/" title="Simply Exploration of LLM PEFT Fine-tuning and Ollama Operation">Simply Exploration of LLM PEFT Fine-tuning and Ollama Operation</a><time datetime="2025-12-18T16:00:00.000Z" title="Created 2025-12-19 00:00:00">2025-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/2025/08/16/2025-8-16-Simply%20Exploration%20of%20Unity%20YooAsset%20+%20HybridCLR%20Hot%20Update/" title="Simply Exploration of Unity YooAsset + HybridCLR Hot Update"><img src="https://pic1.zhimg.com/v2-09bfa8f60abc5361104c7584f6df43cd_720w.jpeg?source=d16d100b" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Simply Exploration of Unity YooAsset + HybridCLR Hot Update"/></a><div class="content"><a class="title" href="/en/2025/08/16/2025-8-16-Simply%20Exploration%20of%20Unity%20YooAsset%20+%20HybridCLR%20Hot%20Update/" title="Simply Exploration of Unity YooAsset + HybridCLR Hot Update">Simply Exploration of Unity YooAsset + HybridCLR Hot Update</a><time datetime="2025-08-15T16:00:00.000Z" title="Created 2025-08-16 00:00:00">2025-08-16</time></div></div></div></div></div></div></main><footer id="footer" style="background: rgba(1,1,1,0)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2026 By YiZhen</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="translateLink" type="button" title="Toggle Between Chinese And English">EN</button><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js?v=4.13.0"></script><script src="/en/js/main.js?v=4.13.0"></script><script src="/en/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{
  const getGiscusTheme = theme => {
    return theme === 'dark' ? 'dark' : 'light'
  }

  const loadGiscus = () => {
    const config = Object.assign({
      src: 'https://giscus.app/client.js',
      'data-repo': 'ayinzhang/ayinzhang.github.io',
      'data-repo-id': 'R_kgDOKl3Dog',
      'data-category-id': 'DIC_kwDOKl3Dos4CaqXe',
      'data-mapping': 'pathname',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true
    },null)

    const ele = document.createElement('script')
    for (let key in config) {
      ele.setAttribute(key, config[key])
    }
    document.getElementById('giscus-wrap').appendChild(ele)
  }

  const changeGiscusTheme = theme => {
    const sendMessage = message => {
      const iframe = document.querySelector('iframe.giscus-frame')
      if (!iframe) return
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app')
    }

    sendMessage({
      setConfig: {
        theme: getGiscusTheme(theme)
      }
    });
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment= loadGiscus
  }
})()</script></div><script data-pjax src="/en/self/btf.js"></script><script data-pjax src="/en/self/tw_en.js"></script><div class="aplayer no-destroy" data-id="8985244058" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"> </div><script id="canvas_nest" defer="defer" color="0,0,0" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="true" data-text="且行且看,尽力而为,不要害怕,不要后悔" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["link[rel=\"canonical\"]","meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/en/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/en/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/en/live2dw/assets/elica.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"right","hOffset":20,"vOffset":-130},"mobile":{"show":false,"scale":0.3},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>